var fs=require("fs"),_=require("underscore"),q=require("q"),e=require("./errors.json")[0],EasyQuery=function(){function t(t){var r=this;this.queued="$screen: 'only screen' !default;\n\n@function lower-bound($range) {\n\n\t@if length($range) <= 0 {\n\t\t@return 0;\n\t}\n\n\t@return nth($range, 1);\n}\n\n@function upper-bound($range) {\n\n\t@if length($range) < 2 {\n\t\t@return 999999999999;\n\t}\n\n\t@return nth($range, 2);\n\n",this.languages=["sass","scss","less"],this._initialize=function(t){if(t)r._readLang(t),r._readBuildCSS(t),r._readBuildVars(t),r._readRem(t),r._readLib(t);else try{r.lib=require("./frameworks/bootstrap3")}catch(n){r._throwException(e.E2L002)}r.$rpx=r._pxToRem(1)},this._readLib=function(t){if(t.hasOwnProperty("lib")&&!!t.lib==!0&&"object"==typeof t){var n=t.lib;if(n.constructor===Array)r._readCustomArray(n);else if("string"==typeof n)try{var i=n.toString();r.lib=require("./frameworks/"+i)}catch(s){r._throwException(e.E2L001)}}else if("string"==typeof t)try{var i=t.toString();r.lib=require("./frameworks/"+i)}catch(s){r._throwException(e.E2L001)}},this._readLang=function(t){t.hasOwnProperty("lang")&&_.contains(r.languages,t.lang.toLowerCase())?r.lang=t.lang:t.hasOwnProperty("lang")&&r._throwException(e.E2G001)},this._readRem=function(t){t.hasOwnProperty("rem")&&t.rem!==!1&&"number"==typeof t.rem?r.remSize=t.rem:t.hasOwnProperty("rem")&&t.rem!==!1&&r._throwException(e.E2G008)},this._readBuildCSS=function(t){t.hasOwnProperty("buildCSS")&&t.buildCSS===!0?r.buildVars=!0:t.hasOwnProperty("buildCSS")&&t.buildCSS!==!1?r._throwException(e.E2G002):r.buildVars=!1},this._readBuildVars=function(t){t.hasOwnProperty("buildVars")&&t.buildVars===!0?r.buildVars=!0:t.hasOwnProperty("buildVars")&&t.buildVars!==!1?r._throwException(e.E2G003):r.buildVars=!1},this._readCustomArray=function(t){if(t.constructor===Array){var n=_.every(t,function(e){r._validateArrayValue(e)});n===!1?r._throwException(e.E2G004):r._parseCustomArray(r.config.lib)}else"string"==typeof t?r.lib=t.lib:r._throwException(e.E2G005)},this._validateArrayValue=function(t){return"string"==typeof t?/^[0-9]+(px|em|rem)$/.test(t.toLowerCase()):void r._throwException(e.E2G006)},this._parseCustomArray=function(e){_.each(e,function(e,t){var n=e.match(/^([-.\d]+(?:.\d+)?)(.*)$/),i=n[1].trim(),s=n[2].trim();_.contains("px",s)&&(i=r._pxToRem(i)),r.lib[t]=i})},this._pxToRem=function(e){return e/r.remSize},this._throwException=function(e,t){if(e&&"object"==typeof e){if("Error"===e.type){var n=t;throw new Error("easy-query: ["+e.code+"] "+e.title+": "+e.message+n)}r.debugMode||("Warning"===e.type&&console.error("["+e.code+"] "+e.title+": "+e.message),"Information"===e.type&&console.log("["+e.code+"] "+e.title+": "+e.message))}},this._getBreakNames=function(e){if("number"==typeof e&&e>=1&&e<=5)switch(e){case 1:return["sm","lg"];case 2:return["sm","md","lg"];case 3:return["xs","sm","md","lg"];case 4:return["xs","sm","md","lg","xl"];case 5:return["xs","sm","md","lg","xl","xx"]}else r._throwException(e<1||e>5?"E2G007":"E2G008")},this._generateRange=function(e,t){return r.pfx+e[t]+"-range: ("+r._pxToRem(r.lib[t])+", "+r._pxToRem(r.lib[++t]-r.$rpx)+");\n"},this._isFirst=function(e,t){return r.queued+=r.pfx+e[t]+"-only: '"+r.query+"screen} and (max-width: "+(r.lib[0]-r.$rpx)+"rem)';\n",r.queued+="."+e[t]+"-only "+r.braceL+"\n\tdisplay: none;\n"+r.braceR+"\n\n",r.queued},this._isInner=function(e,t){var n=e[t+1],i=e[t-1],s=e[t],o=r.lib[t-1],a=r.lib[t];return r.queued+=r._generateRange(e,t),r.queued+=r.pfx+s+"-up: '#{$screen} and (min-width: "+o+"rem);",r.queued+=r.pfx+s+"-down: '"+r.query+"screen} and (max-width: "+(a-r.$rpx)+"rem);",r.queued+=r.pfx+s+"-only: '"+r.query+"screen} and (min-width: "+o+"rem) and (max-width: "+(a-r.$rpx)+"rem);",r.queued+="."+s+"-up "+r.braceL+"\n\t@media "+r.query+i+"-"+("sm"===s?"only":"down")+r.braceR+" "+r.braceL+"\n\t\tdisplay: none;\n\t"+r.braceR+"\n"+r.braceR+"\n\n;",r.queued+="."+s+"-down "+r.braceL+"\n\t@media "+r.query+n+"-"+(r.lib.length-1===t?"only":"up")+r.braceR+" "+r.braceL+"\n\t\tdisplay: none;\n}\n\t}\n\n;",r.queued+="."+s+"-only "+r.braceL+"\n\t@media "+r.query+i+"-"+("sm"===s?"only":"down")+r.braceR+" "+r.braceL+"\n\t\tdisplay: none;\n\t"+r.braceR+"\n\n\t@media "+r.query+n+"-"+(r.lib.length-1===t?"only":"up")+r.braceR+" "+r.braceL+"\n\t\tdisplay: none;\n"+r.braceR+"\n\t"+r.braceR+"\n\n",r.queued},this._isLast=function(e,t){return r.queued+=r.pfx+e[t]+"-only: '"+r.query+"screen} and (min-width: "+r.lib[t]+"rem);\n",r.queued+="."+e[t]+"-only "+r.braceL+"\n\t@media"+r.query+e[0]+"-"+(1===r.lib.length?"only":"down")+r.braceR+" "+r.braceL+"\n\t\tdisplay: none; \n"+r.braceR+"\n\t"+r.braceR+"\n\n",r.queued},this._build=function(t,n){if(r.lib.length){for(var i=r.lib.length,s=r._getBreakNames(i),o=0;o<i;o++)n+=0===o?r._isFirst(s,o):o===i-1?r._isLast(s,o):r._isInner(s,o);return r._writeFile(t,n).then(r._handleWriteFulfill,r._handleWriteError)}r._throwException(e.E2I001)},this._writeFile=function(e,t){var n=q.defer(),i=r.lang;return fs.writeFile(e+"/_easy-query.scss",t,function(t){if(t)n.reject("Could not write to file. Error Message: "+t);else{var r=e+(_.contains(["sass","scss"],i)?"_":"")+"easy-query."+i;n.resolve(r)}}),n.promise},this._handleWriteFulfill=function(e){return e},this._handleWriteError=function(t){r._throwException(e.E2F001,t)},this.write=function(e,t){var n=r._build(e,r.queued);t&&t(n)},this.getCSS=function(){try{if(r.buildCSS)return r.builtCSS;r._throwException(e.E0G111)}catch(t){r._throwException(e.E1P005,t)}},this.getVariables=function(){try{if(r.buildVars===!0){if(r.builtVars)return r.builtVars;r._throwException(e.E2G213)}else r._throwException(e.E0G112)}catch(t){r._throwException(e.E1P006,t)}},this.getLanguage=function(){try{return r.lang}catch(t){r._throwException(e.E1P001,t)}},this.getLanguages=function(){try{return r.languages}catch(t){r._throwException(e.E1P004,t)}},this.setLanguage=function(t){_.contains(r.languages,t)?r.lang=t:r._throwException(e.E1G109)},this.getBreakpoints=function(){try{return r.lib}catch(t){r._throwException(e.E1P003,t)}},this.setBreakpoints=function(e){r._readCustomArray(e)},this.getRemSize=function(){try{return r.remSize}catch(t){r._throwException(e.E1P002,t)}},this.setRemSize=function(t){"number"==typeof t?r.remSize=t:r._throwException(e.E2G110)},this.getDebugMode=function(){try{return r.debugMode}catch(t){r._throwException(e.E1P007,t)}},this.setDebugMode=function(e){r.debugMode=e},this.lang="scss",this.remSize=16,this.config=t,this.buildCSS=!0,this.buildVars=!0,this.pfx="less"===this.lang.toLowerCase()?"@":"$",this.braceL="scss"===this.lang.toLowerCase()?"{":"",this.braceR="scss"===this.lang.toLowerCase()?"}":"",this.query="less"===this.lang.toLowerCase()?"@{":"#{$",this._initialize(this.config)}return t}();module.exports=function(e){return new EasyQuery(e)};
//# sourceMappingURL=index.min.js.map
